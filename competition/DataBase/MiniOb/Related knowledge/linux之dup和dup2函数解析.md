## 文件描述符在内核中数据结构
一个进程在此存在期间，会有一些文件被打开，从而会返回一些文件描述符，从shell中运行一个进程，默认会有3个文件描述符存在(0、１、2)
	*0与进程的标准输入相关联，１与进程的标准输出相关联，2与进程的标准错误输出相关联*
	一个进程当前有哪些打开的文件描述符可以通过/proc/进程ID/fd目录查看
![[Pasted image 20240915004407.png]]

进程表项里通过文件指针来索引到文件表，并通过fd标志来探知文件状态
文件表中
	记录文件状态标志，和fd类似
	当前文件偏移量，和文件大小有关
	结点指针，指向具体的文件，可以索引的实际的信息

每个打开的文件描述符(fd标志)在进程表中都有自己的文件表项，由文件指针指向
## dup/dup2函数
```c
#include <unistd.h>
int dup(int oldfd);
int dup2(int oldfd, int newfd);
```

^02cfdf

这两个函数的作用：复制一个现存的文件描述符

当调用dup函数时，内核在进程中创建一个新的文件描述符
	此描述符是*当前可用文件描述符的最小数值*，这个文件描述符指向oldfd所拥有的文件表项
		即最小地址
	
dup2和dup的区别就是*可以用newfd参数指定新描述符的数值*，如果newfd已经打开，则先将其关闭。
	如果newfd等于oldfd，则dup2返回newfd, 而不关闭它。dup2函数返回的新文件描述符同样与参数oldfd共享同一文件表项。