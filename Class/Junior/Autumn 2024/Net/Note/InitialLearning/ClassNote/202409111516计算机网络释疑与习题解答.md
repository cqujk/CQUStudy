
> [1-1]
> 网络由计算机、结点、和链路组成
> 	结点包含集线器、交换机或路由器
> 		结点把各计算机粘合起来
> 网络就是把许多计算机连接起来
> 而网络的网络是把许多网络连接器起来，包含三个要素——网络、路由器和链路

付费从ISP上得到相应的IP地址，上网就是指通过某个ISP接入到互联网，
^292564


TCP/IP协议族可以使互联网上的任何一对主机都能进行通信，而不管它们的硬件有多大区别

客户和服务器都是指通信中所涉及的应用进程
	客户是服务请求方，服务器是提供者



> [面向连接]
> 电路交换肯定是面向连接的，但面向连接的也可以是分组交换
> 传统的电路交换是面向连接的，IP这种分组交换是无连接的
> 	分组在哪条链路上传送就占用了哪条链路的信道资源，但分组尚未到达的链路则暂时还不占用这部分网络资源（这时，这些资源可以让其它用户使用）
> 			分组交换不是全程占用资源，而是在一段时间占用一段资源
> 				正是因为分组在传输的时候不确定到底用的是什么路，所以需要路由器来进行路由

	

面向连接必须经过三个阶段：
	建立连接->传送数据->释放连接
无连接只有一个阶段：传送数据

在同一时间内，不同层次可以使用不同的连接方式
	电子邮件协议使用面向连接的TCP协议
	TCP协议使用下面的无连接IP协议
	IP协议使用数据链路层的、面向连接的PPP协议
			TCP协议和IP协议是俩东西


IP协议在网络层，IP数据报，只提供一种服务，即无连接服务，在使用IP协议的网络层的上面或下面，都可以使用面向连接服务或无连接服务
IP无连接，因此其传输是不可靠的
![[Pasted image 20240911155845.png|550]]

只要B的TCP发现数据的传输有差错，就告诉A把出错的那部分数据重传，直到正确


运输层根据上层应用程序的性质来确定使用哪种连接服务
	FTP文件传输要求可靠的面向连接的TCP
	实时性可用UDP
数据链路层确定
	拨号电路，则用面向连接
	使用以太网，则用无连接服务

TCP/IP体系最核心是上面的三层，应用层、传输层和网络层
	思路是：形成IP数据报后，只要交给下面的网络去发送
		关键在于形成IP数据报



物理层的连接不一定是使用导线的连接
TDM电话通信：比特从交换机的入口写入到某个时隙，然后隔了非常短的时间后，又在另一个时隙读出，从交换机的出口发送到下一个交换机
	就是说此时就已经不是实时的了，已经不存在真正的物理连接了
			仍然属于电路交换，因为其一直占用这条连接的整个通信资源，其它用户不能共享资源
	移动通信：
		主叫用户手机到基站，基站传输到另一个基站，另一个基站到被叫用户手机，都占用了相应的无线链路的连接
	在此基础上，如果还需要借助地址来完成传输，就是无连接的了



> [1-20分组]
>路由器转发IP数据报，路由器转发帧
分组是将若干个比特加上首部的控制信息封装在一起，组成一个在网络上传输的数据单元
	在数据链路层，这样的数据单元叫做帧
	在IP层，即网络层，就叫IP数据报
	在运输层，叫TCP报文段，UDP用户数据报
协议数据单元PDU，
	在数据链路层的PDU叫做DLPDU
	网络层的PDU叫NPDU
	运输层，TPDU
就是同样的数据（分组，PDU），在不同层的名称不同而已，一般都可统称为分组

由协议层负责将数据处理为分组，在每个数据段前面加上必要的控制信息
	包头包含目的地址和源地址等
路由器用来转发分组，进行分组交换
	每收到一个分组，先临时存储，再检查其首部，查找转发表，按照首部中的目的地址，找到合适的接口转发出去，把这个分组转交给下一个路由器，一步步地经过若干个或几十个不同的路由器，最终交付到目的主机
		各路由器之间必须经常交换彼此掌握的路由信息，以便创建和维持在路由器中的转发表，使得转发表能够在整个网络拓扑发生变化时及时更新


---

服务访问点SAP
	上层使用下层提供的服务通过层间的接口，通过SAP来调用下层的方法


传播速率：信号比特在传输媒体上的传播速率，是电磁波在单位时间内能够在==传输媒体==上走的距离
	这个的单位是m/s，是实际的传播速度
传输速率：计算机每秒向所连接的媒体或网络注入（发送）比特的速度
	这个单位是bits/s
先由主机传输到交换机或者路由器，然后由路由器进行传播
	发送时延=传输时延≠传播时延
*低速信道相当于汽车进入高速公路的时间间隔较长，信道速率提高相当于这个时间变短了*
![[Pasted image 20240911190000.png]]
带宽大了，数据进到物理层的时延就低了

**数据链路层负责把bit送到传输媒体上，物理层就是bit在传输媒体上的传输过程**
	即链路带宽，链路速率的单位是bits/s


？
*吞吐量增大，分组在路由器中等待交换时就会经常处在更长的队列中，因而增加了排队的时间，使时延增大*


协议有三个要素，即语法、语义和同步
	语义说的是要干啥，即发出何种控制信息、完成何种动作以及做出何种响应
		没有说明应当在什么时候做这些动作
	同步详细说明这些事件实现的顺序


*问题*
比较电路和分组交换：传送的报文共x bit，源点到终点共k段链路，每段链路的传播时延为d(s),数据率为b(bit/s)，
电路建立时间为s,分组交换时分组长度为p
*解*
电路和分组都需要通过链路来传播数据，传播时延是相同的
==对于电路：==
	先建立连接，用$s$
	然后把数据传输到链路上，用$x/b$
	链路上进行传播，共k段，用$kd$
总时间为$s+x/b+kd$
==对于分组：==
	传播时延是一样的，都是$kd$
	==不一样的是把数据传输到链路上的过程，==
		分组总数是$n=$$\lceil \frac{x}{p} \rceil$,即总量除以每组大小，向上取整
		每个分组传上去的时间都是$p/b$
			对于最后一个分组的大小一般小于p，但是多少不知道，这里就假定是p
		==除去源节点外，还有$k-1$个结点需要**存储转发**==
			对于这一项就是说，由于不像电路交换一样建立了已有的连接，路都确定了，分组交换在每达到链路上的一个结点后，都需要路由
				所以需要确定每组里的数据都到达，先存储，然后再转发
	发送时延：从发送分组的第一个比特开始，到该分组最后一个比特发送完毕所需要的时间
		从源节点开始，所有的分组都在最后一个分组的前面发送，因此只需要算最后一个分组在$k-1$个结点上面的发送时延
所以其总时间是：所有分组都传到目标节点，即取决于==最后一个分组到目标结点上的时间==
	*这一点对于电路交换也一样适用*
	有两种计算思路
		一种是以最后一组为主：
			为最后一组传输前的等待时间，再加上最后一组在链路上，共$k$个的存储转发时延
		一种是以发送所有分组时的交换机（第一个链路结点）：
			为把所有分组送出第一个链路的时间，再加上最后一个分组在剩余链路，即$k-1$个，上的存储转发时延
	之所以考虑最后一个分组，是因为最后一个分组在存储转发或传播时，其它分组也都在进行，而且比它快
[[Class/Net/Excalidraw/Drawing 2024-09-11 23.15.17.excalidraw]]
所以其总时间为$kd+\lceil \frac{x}{p} \rceil*\frac{p}{b}+(k-1)\frac{p}{b}$
若数据量$x$很大，远大于$p$，则$\lceil \frac{x}{p} \rceil=\frac{x}{p}$

报文长度和分组分别为$x$和$p+h$,
	$p$是数据部分的长度，$h$为每个分组所带控制信息的固定长度，和$p$无关
在计算分组总数时，依然是$x/p$，因为$h$是分完组后由协议添加的
依旧假设$x\gg p$,即分组总数为$x/p$，
总时间=：最后一组的等待时间+最后一组总传输时延
		=$\frac{x-1}{p}\frac{p+h}{b}+k\frac{p+h}{b}$
	=：第一个链路传递所有分组的时间+最后一组走过剩余链路的时间
		=$\frac{x}{p}\frac{p+h}{b}+(k-1)\frac{p+h}{b}$
$p$是人为规定的每个分组，数据部分的大小
为了使总时间最短，可以求总时间对$p$的导数，使其为0得到最合适的每组数据$p$的大小

